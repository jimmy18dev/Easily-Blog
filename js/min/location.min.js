var location_api="api/location",article_api="api/article";$(function(){function t(t,e,a){$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"edit_address",article_id:article_id,province_id:a,amphur_id:e,district_id:t},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),location.reload()})}$locationList=$("#locationList"),$("#findLocation").keydown(function(e){if(13==e.keyCode){$selected=$("#locationList .selected");var a=$selected.attr("data-district"),i=$selected.attr("data-amphur"),o=$selected.attr("data-province");t(a,i,o)}else if(38==e.keyCode){var n=$(".selected");$("#locationList .location-items").removeClass("selected"),0==n.prev().length?n.siblings().last().addClass("selected"):n.prev().addClass("selected")}else if(40==e.keyCode){var n=$(".selected");$("#locationList .location-items").removeClass("selected"),0==n.next().length?n.siblings().first().addClass("selected"):n.next().addClass("selected")}}),$("#findLocation").on("input",function(){var t=$(this).val();return!t||t.length<=1?($("#locationList").html(""),!1):($.ajax({url:location_api,cache:!1,dataType:"json",type:"GET",data:{request:"find",keyword:t},error:function(t){console.log(t.responseText)}}).done(function(t){var e="";$.each(t.dataset,function(t,a){console.log(a.district_name+" "+a.amphur_name+" "+a.province_name),e+='<li class="location-items" data-district="'+a.district_id+'" data-amphur="'+a.amphur_id+'" data-province="'+a.province_id+'"><i class="fa fa-map-marker" aria-hidden="true"></i>'+(a.district_name?"ต."+a.district_name+" ":"")+(a.amphur_name?"อ."+a.amphur_name+" ":"")+(a.province_name?"จ."+a.province_name:"")+"</li>"}),$("#locationList").html(e),$("#locationList").children(".location-items").first().addClass("selected")}),void 0)}),$("#locationList").on("click",".location-items",function(){var e=$(this).attr("data-district"),a=$(this).attr("data-amphur"),i=$(this).attr("data-province");t(e,a,i)})});