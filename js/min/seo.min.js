var article_api="api/article",article_id=$("#article_id").val();$(document).ready(function(){var e;$description=$("#description"),$description.focus(function(){e=$(this).val()}),$description.blur(function(){var a=$(this).val();return e==a?(inprogress(),!1):($progressbar.fadeIn(300),$progressbar.width("0%"),$progressbar.animate({width:"70%"},500),$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"edit_description",article_id:article_id,description:a},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e),$progressbar.animate({width:"100%"},500),$progressbar.fadeOut(300)}),void 0)}),$(".cover-items").click(function(){$this=$(this);var e=$(this).attr("data-cover");$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"set_cover",article_id:article_id,cover_id:e},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e),$(".cover-items").removeClass("active"),$this.addClass("active")})}),$(".btn-remove-tag").click(function(){$tag=$(this).parent();var e=$tag.attr("data-id"),a=$tag.attr("data-name");return confirm('คุณต้องการลบ "'+a+'" ใช่หรือไม่ ?')?($.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"remove_tag",article_id:article_id,tag_id:e},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e),$tag.fadeOut(300)}),void 0):!1}),$("#tagForm").submit(function(e){e.preventDefault();var a=$("#tag-input").val();$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"add_tag",article_id:article_id,tag:a},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e),location.reload()})}),$("#articleURL").on("blur",function(){var e=$(this).val();console.log(e),$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"edit_url",article_id:article_id,url:e},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e)})}),$("#btn-publish").click(function(){$progressbar.fadeIn(300),$progressbar.width("0%"),$progressbar.animate({width:"70%"},500),$(this).html('<span>กำลังเผยแพร่</span><i class="fa fa-spinner fa-spin" aria-hidden="true"></i>'),$.ajax({url:article_api,cache:!1,dataType:"json",type:"POST",data:{request:"change_status",article_id:article_id,status:"published"},error:function(e){console.log(e.responseText)}}).done(function(e){console.log(e),$progressbar.animate({width:"100%"},500),$progressbar.fadeOut(),setTimeout(function(){window.location="article/"+article_id},1e3)})})});